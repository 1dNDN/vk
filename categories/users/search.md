---
layout: default
title: Метод Users.Search
permalink: users/search/
comments: true
---
# Метод Users.Search
Возвращает список пользователей в соответствии с заданным критерием поиска.

# Синтаксис
```csharp

```

## Параметры
+ **query** - Строка поискового запроса.
+ **itemsCouns** - Общее количесво записей удовлетворяющих поисковому запросу.
+ **fields** - Перечисленные через запятую поля анкет, необходимые для получения.
+ **count** - Количество возвращаемых пользователей.
+ **offset** - Смещение относительно первого найденного пользователя для выборки определенного подмножества.

## Результат
Возвращает количество пользователей, найденных в соответствии с поисковой строкой **query**, и информацию о пользователях в виде перечисления объектов типа Profile, каждый из которых может иметь набор полей, определённых параметром **fields**.

## Исключения
+ **AccessTokenInvalidException** - не задан или используется неверный AccessToken.
+ **ArgumentException** - строка поискового запроса пуста или равна значению null.

## Пример
```csharp
// Выбор первых двадцати Ивановых Маш.
int count; // хранит общее количество Ивановых Маш зарегистрированных во ВКонтаке
var users = vk.Users.Search("Masha Ivanova", count);
foreach (Profile user in users)
{
   .....
}

// Получение всей информации о первых 5 Ивановых Машах, начиная с 15 позиции.
int count; // хранит общее количество Ивановых Маш зарегистрированных во ВКонтаке
var users = vk.Users.Search("Masha Ivanova", count, ProfileFields.All, 5, 15);
```

