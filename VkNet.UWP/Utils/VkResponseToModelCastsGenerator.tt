<#@ template debug="false" hostspecific="true" language="C#" #>
<#@ assembly name="System.Core" #>
<#@ import namespace="System.IO" #>
<#@ import namespace="System.Linq" #>
<#@ import namespace="System.Collections.Generic" #>
<#@ import namespace="System.Text.RegularExpressions" #>
<#@ output extension=".cs" #>
// DO NOT EDIT THIS FILE CAUSE ALL CHANGES WILL BE DELETED AUTOMATICALLY
using VkNet.Model;
using VkNet.Model.Attachments;
using VkNet.Model.RequestParams;
using System.Collections.ObjectModel;
namespace VkNet.Utils
{
    public partial class VkResponse
    {
<#
	var path = Path.Combine(Directory.GetParent(Host.ResolvePath("")).ToString(), "Model");
	var files = Directory.GetFiles(path, "*.cs", SearchOption.AllDirectories).ToList();

	var types = new List<string>();

	foreach (var file in files)
	{
		var text = File.ReadAllText(file);
		var pattern = @"static (\w+) FromJson\(VkResponse [a-zA-Z]*?\)";

		var matches = Regex.Matches(text, pattern, RegexOptions.Multiline);

		foreach (var match in matches)
		{
			var type = Regex.Replace(match.ToString(), pattern, @"$1", RegexOptions.Multiline);
			types.Add(type);
		}
	}

	foreach (var type in types.OrderBy(s => s))
		{
#>
		/// <summary>
        /// Преобразовать из <see cref="VkResponse"/> в <see cref="<#= type #>"/>.
        /// </summary>
        /// <param name="response">Ответ.</param>
        /// <returns>
        /// Результат преобразования.
        /// </returns>
		public static implicit operator <#= type #>(VkResponse response)
		{
            return response?._token == null || !response._token.HasValues ? null :  <#= type #>.FromJson(response);
        }

		/// <summary>
        /// Преобразовать из <see cref="VkResponse"/> в <see cref="Collection{<#= type #>}"/>.
        /// </summary>
        /// <param name="response">Ответ.</param>
        /// <returns>
        /// Результат преобразования.
        /// </returns>
		public static implicit operator Collection<<#= type #>>(VkResponse response)
        {
            return response.ToCollectionOf<<#= type #>>(a => a);
        }

<# } #>

	}
}
